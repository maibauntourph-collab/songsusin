# 📖 모바일 가이드 시스템 사용 설명서 (User Guide)

이 문서는 선생님(가이드)과 학생(관광객)이 시스템을 원활하게 사용하기 위한 **설치 및 접속 가이드**입니다.

## 🖥️ 1. PC (서버/가이드용 컴퓨터) 준비사항
PC는 **방송국 역할**을 합니다. 프로그램을 설치하고 실행해야 합니다.

### A. 설치할 것 (Installation)
1.  **Python (파이썬) 설치**:
    - [Python 공식 홈페이지](https://www.python.org/downloads/)에서 최신 버전을 다운로드하여 설치합니다.
    - ⚠️ 설치 시 **"Add Python to PATH"** 체크박스를 꼭! 체크해주세요.
2.  **코드 다운로드**:
    - 현재 폴더(`mobile-guide-system`)를 준비합니다.
3.  **라이브러리(부품) 설치**:
    - `명령 프롬프트(cmd)` 또는 `터미널`을 열고, 프로젝트 폴더로 이동한 뒤 아래 명령어를 입력합니다.
    ```bash
    pip install -r requirements.txt
    ```

### B. 실행 및 연결 (Running)
1.  **서버 켜기**:
    ```bash
    python server.py
    ```
    - 이제 내 컴퓨터에서 방송국이 켜졌습니다 (`http://0.0.0.0:5000`).
2.  **외부망 연결 (ngrok) - 필수!**:
    - 핸드폰은 보안 때문에 **HTTPS(보안 연결)**가 아니면 마이크를 켜주지 않습니다.
    - 가장 쉬운 방법은 **ngrok**이라는 도구를 쓰는 것입니다.
    - [ngrok 다운로드](https://ngrok.com/download) 후 실행하여 아래 명령어를 입력합니다.
    - **중요**: 처음 실행한다면 [ngrok 사이트](https://dashboard.ngrok.com/get-started/your-authtoken)에 가입하고 토큰(Authtoken)을 등록해야 합니다.
    ```bash
    # 1. 토큰 등록 (최초 1회만)
    ngrok config add-authtoken <여기에_토큰_복사_붙여넣기>
    
    # 2. 실행
    ngrok http 5000
    ```
    - 화면에 나오는 주소 중 `Forwarding` 옆의 주소(예: `https://abcd-1234.ngrok-free.app`)가 **"입장권(URL)"**이 됩니다.

---

## 📱 2. 핸드폰 (가이드 및 관광객) 준비사항
핸드폰에는 **아무것도 설치할 필요가 없습니다!** (앱 설치 X)

### A. 가이드 (방송하는 사람)
1.  핸드폰 브라우저(Chrome, Safari 등)를 켭니다.
2.  위에서 만든 **ngrok 주소**(`https://...`)로 접속합니다.
3.  **"I am Guide"** 버튼을 누릅니다.
4.  마이크 권한 요청이 뜨면 **[허용]**을 누릅니다.
5.  **[Start Broadcast]** 버튼을 누르면 방송이 시작됩니다.

### B. 관광객 (듣는 사람)
1.  가이드가 보내준 **ngrok 주소**를 문자나 카카오톡으로 받아 접속합니다.
2.  **"I am Tourist"** 버튼을 누릅니다.
3.  화면의 "**Tap to Enable Audio**" 버튼을 한 번 눌러줍니다. (소리가 나올 준비를 하는 과정입니다)
4.  이제 가이드의 목소리가 들립니다!

---

## ❓ 자주 묻는 질문 (FAQ)
- **Q: 소리가 안 들려요!**
    - A: 관광객 화면에 "Tap to Enable Audio" 버튼이 남아있다면 꼭 눌러주세요. 아이폰의 경우 매너모드가 해제되어 있는지 확인해주세요.
- **Q: 같은 와이파이인데 ngrok이 필요한가요?**
    - A: 네, 핸드폰 브라우저는 `https`가 아니면 마이크/오디오 기능을 막는 경우가 많습니다. 개발 단계에서는 ngrok을 쓰는 것이 정신 건강에 좋습니다.

---

## 🛠️ 3. 주요 기능 업데이트 (Key Features Update)

### A. 서버 컨트롤 툴바 (Server Control Toolbar)
화면 최상단에 **새로운 제어 아이콘**들이 추가되었습니다.
- **🔄 (Refresh)**: 화면을 새로고침합니다.
- **▶️ (Run/Start)**: 가이드 방송(Broadcast)을 시작합니다. ("Start Broadcast" 버튼과 동일)
- **🛑 (Stop Server)**: 서버 프로그램을 **완전히 종료**합니다. (주의: 모든 사용자의 연결이 끊깁니다)

### B. 세션 히스토리 (Session History)
- 가이드 화면 하단 **Guide Admin Panel**에 **"Session History"** 섹션이 생겼습니다.
- 가이드가 말한 내용이 **텍스트로 자동 저장**되며, 언제든지 확인하고 텍스트 파일로 다운로드할 수 있습니다.
- **"Refresh Text Log"** 버튼을 눌러 최신 대화 불러오기.

### C. 오디오 녹음 (Audio Recording)
- 가이드가 방송을 시작하면 서버가 **자동으로 녹음**을 시작합니다.
- 방송 종료 후 **"Refresh Audio"** 버튼을 누르면 녹음된 파일 목록이 뜹니다.
- **Download** 버튼을 눌러 `.wav` 파일을 바로 다운로드하세요.
